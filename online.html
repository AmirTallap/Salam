<!DOCTYPE html>
<html dir="ltr" lang="en_US">

<head>
    <title>Salam Programming Language</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <textarea dir="rtl" style="text-align: right; direction: rtl;" id="code" rows="20" cols="40">عملکرد سلام {
    نمایش "سلام، دنیا!"
}
</textarea>
    <br>
    <button id="execute">Run!</button>
    <pre></pre>

    <script type="text/javascript">
const codeTextArea = document.querySelector('#code');
const executeButton = document.querySelector('#execute');
const outputPre = document.querySelector('pre');

// Set initial arguments
var args = ['--code', ''];

var Module = {
    noInitialRun: true,
    onRuntimeInitialized: function () {
        console.log('Wasm loaded successfully');
    },
    print: function (text) {
        if (outputPre) {
            outputPre.textContent += text + '\n';
        }
        console.log(text);
    }
};

function captureOutput(arguments) {
    if (outputPre) {
        outputPre.textContent = '';
    }

    var output = '';

    var originalConsoleLog = console.log;
    console.log = function (text) {
        output += text + '\n';
    };

    callMain(arguments);

    console.log = originalConsoleLog;

    if (outputPre) {
        outputPre.textContent = output;
    }

    return output;
}

// Function to run Salam code
function runSalam() {
    console.log('Running Salam code...');
    const code = codeTextArea.value.toString().trim();

    if (!code) {
        alert('Code is empty! Please enter Salam code.');
        return;
    }

    // Update arguments
    args[1] = code;
    console.log('Calling run() with arguments:', args);

    // Capture the output and display in <pre> tag
    captureOutput(args);
}

// Add an event listener for the execute button
executeButton.addEventListener('click', function () {
    console.log('Button clicked!');
    runSalam();
});


        // Load the script
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = 'salam.js';
        document.body.appendChild(script);
    </script>
</body>

</html>
